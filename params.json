{"name":"Doctrine DateInterval","tagline":"Supports DateInterval in Doctrine DBAL and ORM.","body":"Doctrine DateInterval Type\r\n==========================\r\n\r\n[![Build Status](https://travis-ci.org/herrera-io/php-doctrine-dateinterval.png?branch=master)](https://travis-ci.org/herrera-io/php-doctrine-dateinterval)\r\n\r\nSupports DateInterval in Doctrine DBAL and ORM.\r\n\r\nSummary\r\n-------\r\n\r\nThe `DateInterval` library\r\n\r\n- adds a `dateinterval` type to DBAL\r\n- adds a `DATE_INTERVAL` DQL function to ORM\r\n\r\nThis is made possible by the [`DateInterval`](https://github.com/herrera-io/php-date-interval) library.\r\n\r\nInstallation\r\n------------\r\n\r\nAdd it to your list of Composer dependencies:\r\n\r\n```sh\r\n$ composer require herrera-io/doctrine-dateinterval=1.*\r\n```\r\n\r\nRegister it with Doctrine DBAL:\r\n\r\n```php\r\n<?php\r\n\r\nuse Doctrine\\DBAL\\Types\\Type;\r\nuse Herrera\\Doctrine\\DBAL\\Types\\DateIntervalType;\r\n\r\nType::addType(\r\n    DateIntervalType::DATEINTERVAL,\r\n    'Herrera\\\\Doctrine\\\\DBAL\\\\Types\\\\DateIntervalType'\r\n);\r\n```\r\n\r\nRegister it with Doctrine ORM:\r\n\r\n```php\r\n<?php\r\n\r\n$entityManager->getConfiguration()->addCustomDatetimeFunction(\r\n    'Herrera\\\\Doctrine\\\\ORM\\\\Query\\\\AST\\\\Functions\\\\DateIntervalFunction'\r\n);\r\n```\r\n\r\nUsage\r\n-----\r\n\r\n```php\r\n<?php\r\n\r\n/**\r\n * @Entity()\r\n * @Table(name=\"Jobs\")\r\n */\r\nclass Job\r\n{\r\n    /**\r\n     * @Column(type=\"integer\")\r\n     * @GeneratedValue(strategy=\"AUTO\")\r\n     * @Id()\r\n     */\r\n    private $id;\r\n\r\n    /**\r\n     * @Column(type=\"dateinterval\")\r\n     */\r\n    private $interval;\r\n\r\n    /**\r\n     * @return DateInterval\r\n     */\r\n    public function getInterval()\r\n    {\r\n        return $this->interval;\r\n    }\r\n\r\n    /**\r\n     * @param DateInterval $interval\r\n     */\r\n    public function setInterval(DateInterval $interval)\r\n    {\r\n        $this->interval = $interval;\r\n    }\r\n}\r\n\r\n$annualJob = new Job();\r\n$annualJob->setInterval(new DateInterval('P1Y'));\r\n\r\n$monthlyJob = new Job();\r\n$monthlyJob->setInterval(new DateInterval('P1M'));\r\n\r\n$dailyJob = new Job();\r\n$dailyJob->setInterval(new DateInterval('P1D'));\r\n\r\n$entityManager->persist($annualJob);\r\n$entityManager->persist($monthlyJob);\r\n$entityManager->persist($dailyJob);\r\n$entityManager->flush();\r\n$entityManager->clear();\r\n\r\n$jobs = $entityManager->createQuery(\r\n    \"SELECT j FROM Jobs j WHERE j.interval < DATE_INTERVAL('P1Y') ORDER BY j.interval ASC\"\r\n)->getResult();\r\n\r\necho $jobs[0]->getInterval()->toSpec(); // \"P1D\"\r\necho $jobs[1]->getInterval()->toSpec(); // \"P1M\"\r\n```\r\n\r\n> **NOTICE** The date interval instances returned are of `Herrera\\DateInterval\\DateInterval`.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}